<!doctype html><html lang=en data-mode=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Image Restoration Using GAN's Part-1 | g00g1y5p4's Blog</title><link rel=apple-touch-icon href=https://g00g1y5p4.github.io/images/favicons/apple-touch-icon.png sizes=180x180><link rel=icon href=https://g00g1y5p4.github.io/images/favicons/favicon-32x32.png sizes=32x32 type=image/png><link rel=icon href=https://g00g1y5p4.github.io/images/favicons/favicon-16x16.png sizes=16x16 type=image/png><link rel=manifest href=https://g00g1y5p4.github.io/images/favicons/manifest.json><link rel=icon href=https://g00g1y5p4.github.io/images/favicons/favicon.ico><meta name=keywords content><meta name=description content="Image Restoration with GAN's for medical field problems"><meta itemprop=name content="Image Restoration Using GAN's Part-1"><meta itemprop=description content="Image Restoration with GAN's for medical field problems"><meta itemprop=datePublished content="2020-09-06T07:34:48+08:30"><meta itemprop=dateModified content="2020-09-06T07:34:48+08:30"><meta itemprop=wordCount content="583"><meta itemprop=image content="https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/_card.png"><meta itemprop=keywords content="Machine Learning,Deep Learning,Image Processing,"><meta property="og:title" content="Image Restoration Using GAN's Part-1"><meta property="og:description" content="Image Restoration with GAN's for medical field problems"><meta property="og:type" content="article"><meta property="og:url" content="https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/"><meta property="og:image" content="https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/_card.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-09-06T07:34:48+08:30"><meta property="article:modified_time" content="2020-09-06T07:34:48+08:30"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/_card.png"><meta name=twitter:title content="Image Restoration Using GAN's Part-1"><meta name=twitter:description content="Image Restoration with GAN's for medical field problems"><meta name=twitter:site content="@g00g1y5p4"><link rel=preload href=https://g00g1y5p4.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin=anonymous as=style onload='this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://g00g1y5p4.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin=anonymous></noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Consolas" type=text/css media=all referrerpolicy=no-referrer><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Fira+Code" type=text/css media=all><style>body{font-family:consolas}code{font-family:fira code}code{tab-size:4}</style></head><body><script src=https://g00g1y5p4.github.io/js/bootstrap.min.062c2e66b557cb779d59cedff7e0cc76e84beb665a1076e474e87d940be44245.js integrity="sha256-BiwuZrVXy3edWc7f9+DMduhL62ZaEHbkdOh9lAvkQkU=" crossorigin=anonymous></script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top"><div class=container><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-bars"></i>
</button><a class="navbar-brand me-3" href=https://g00g1y5p4.github.io/>g00g1y5p4's Blog</a>
<button class=navbar-social-share type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasSocialShare aria-controls=offcanvasSocialShare aria-label="Toggle social share">
<i class="fas fa-share-alt"></i></button><div class="offcanvas offcanvas-bottom surface" tabindex=-1 id=offcanvasSocialShare aria-labelledby=offcanvasSocialShare><div class=offcanvas-header><h3 class=offcanvas-title>Share</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class=offcanvas-body><a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button" target=_blank href="https://twitter.com/intent/tweet?title=Image%20Restoration%20Using%20GAN%27s%20Part-1&url=https%3a%2f%2fg00g1y5p4.github.io%2fposts%2fimagrestorationusinggans_1%2f"><i class="fab fa-fw fa-twitter"></i> Twitter</a>
<a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fg00g1y5p4.github.io%2fposts%2fimagrestorationusinggans_1%2f"><i class="fab fa-fw fa-facebook-f"></i> Facebook</a></div></div><button class=navbar-settings type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasSettings aria-controls=offcanvasSettings aria-label="Toggle settings">
<i class="fas fa-ellipsis-v"></i></button><div class="offcanvas offcanvas-end surface h-100" tabindex=-1 id=offcanvasSettings aria-labelledby=offcanvasSettings><div class=offcanvas-header><h3 class=offcanvas-title>Settings</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class=offcanvas-body><section class=setting><form class="font-size-switcher-form row"><div class=col-auto><label for=fontSize class=form-label><i class="fas fa-fw fa-font"></i> Font Size</label></div><div class="col-auto ms-auto"><input type=range class=form-range min=-2 max=2 id=fontSize></div></form></section><section class="setting palettes"><form class=row><div class=col-auto><label><i class="fas fa-fw fa-palette"></i> Palette</label></div><div class="col-auto ms-auto"><a id=btnPalette class="btn btn-sm btn-outline-primary" role=button aria-label=palettePicker><i class="fas fa-eye-dropper"></i></a></div></form><div class="mt-2 d-flex visually-hidden" id=palettePicker><button type=button id=palette-blue aria-label=Blue class="btn btn-sm palette" data-palette=blue>
</button><button type=button id=palette-blue-gray aria-label="Blue Gray" class="btn btn-sm palette" data-palette=blue-gray>
</button><button type=button id=palette-brown aria-label=Brown class="btn btn-sm palette" data-palette=brown>
</button><button type=button id=palette-cyan aria-label=Cyan class="btn btn-sm palette" data-palette=cyan>
</button><button type=button id=palette-green aria-label=Green class="btn btn-sm palette" data-palette=green>
</button><button type=button id=palette-indigo aria-label=Indigo class="btn btn-sm palette" data-palette=indigo>
</button><button type=button id=palette-orange aria-label=Orange class="btn btn-sm palette" data-palette=orange>
</button><button type=button id=palette-pink aria-label=Pink class="btn btn-sm palette" data-palette=pink>
</button><button type=button id=palette-purple aria-label=Purple class="btn btn-sm palette" data-palette=purple>
</button><button type=button id=palette-red aria-label=Red class="btn btn-sm palette" data-palette=red>
</button><button type=button id=palette-teal aria-label=Teal class="btn btn-sm palette" data-palette=teal>
</button><button type=button id=palette-yellow aria-label=Yellow class="btn btn-sm palette" data-palette=yellow></button></div></section></div></div><div class="collapse navbar-collapse" tabindex=-1 id=navbarSupportedContent aria-labelledby=navbarSupportedContent><ul class="navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/archives/><i class="fas fa-fw fa-file-archive"></i>Archives</a></li><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/categories/><i class="fas fa-fw fa-folder"></i>Categories</a></li><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/tags/><i class="fas fa-fw fa-tags"></i>Tags</a></li><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/series/><i class="fas fa-fw fa-columns"></i>Series</a></li></ul></div></div></nav></header><main role=main class=container><div class="row content"><div class=col-lg-8><div class=container><nav class="row card component" aria-label=breadcrumb><div class=card-body><ol class=breadcrumb><li class=breadcrumb-item><a href=https://g00g1y5p4.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://g00g1y5p4.github.io/posts/>Posts</a></li><li class="breadcrumb-item active">Image Restoration Using GAN's Part-1</li></ol></div></nav><article class="row card component mb-4 post"><div class=post-panel-wrapper><div class="d-flex flex-column component rounded post-panel"><a id=sidebarToggler class="action d-none d-lg-block" role=button><i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i></a></div></div><div class=card-body><h1 class="card-title my-3">Image Restoration Using GAN's Part-1</h1><div class=post-meta><span class=post-date title="created on"><i class="fas fa-fw fa-calendar-alt"></i>Sep 6, 2020
</span><span class=post-reading-time title="reading time"><i class="fas fa-fw fa-coffee"></i>3 min read
</span><a href=https://g00g1y5p4.github.io/categories/gans/ class="badge rounded-pill text-white bg-primary post-taxonomy">GAN's</a><a href=https://g00g1y5p4.github.io/tags/machine-learning/ class="badge rounded-pill text-white bg-primary post-taxonomy">Machine Learning</a><a href=https://g00g1y5p4.github.io/tags/deep-learning/ class="badge rounded-pill text-white bg-primary post-taxonomy">Deep Learning</a><a href=https://g00g1y5p4.github.io/tags/image-processing/ class="badge rounded-pill text-white bg-primary post-taxonomy">Image Processing</a></div><div class="post-content mb-3"><h2 id=what-is-gans>What is GAN&rsquo;s?</h2><p>Generative Adversarial Networks <a href=https://arxiv.org/abs/1406.2661 target=_blank rel="noopener noreferrer">GAN&rsquo;s</a>
are one of the most interesting ideas in computer science today. Two models are trained simultaneously by an adversarial process. A generator learns to create images that look real, while a discriminator learns to tell real images apart from fakes.
<img class="img-fluid mx-auto d-block" alt=images/home.jpg src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/home.jpg loading=lazy width=1050 height=520></p><h3 id=case><strong>Case:</strong></h3><p>I have read that, in most of the cases Doctors may face issues while they are making decisions over CT scanned Images because of Gaussian Noise and making electronic Noise (unwanted disturbance in a signal which is reflected in output).
So I tried to implement and train a Deep Learning model using GAN Technology.
<img class="img-fluid mx-auto d-block" alt=images/output.jpg src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/output.png loading=lazy width=851 height=276></p><h5 id=brief-solution><strong>Brief Solution:</strong></h5><p>Step-1. Preprocessing the Data to train the model.</p><p>Step-2. Generator Model: Used to generate new images which look like real images.</p><p>Step-3. Discriminator Model: Used to classify images as real or fake.</p><p>Step-4. Fitting the model.</p><h5 id=detailed-solution><strong>Detailed Solution:</strong></h5><p>We’ll begin by importing needed libraries, considering you’ve installed all the necessary libraries already.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>IPython.display</span> <span class=kn>import</span> <span class=n>display</span><span class=p>,</span> <span class=n>HTML</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span><span class=p>,</span><span class=n>ImageFile</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorFlow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>io</span> <span class=kn>import</span> <span class=n>BytesIO</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span><span class=o>,</span><span class=nn>sys</span><span class=o>,</span><span class=nn>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>%</span><span class=n>matplotlib</span> <span class=n>inline</span>
</span></span></code></pre></div><p>Okay,the libraries are succesfully imported and lets go to the next part of this process. Define some filters manually using numpy and image processing techniques to morph the original image.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>add_noise</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>a2</span> <span class=o>=</span> <span class=n>a</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>rows</span> <span class=o>=</span> <span class=n>a2</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>cols</span> <span class=o>=</span> <span class=n>a2</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=mi>2</span> <span class=c1># size of spot is 1/20 of smallest dimension</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=n>cols</span><span class=o>-</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=n>rows</span><span class=o>-</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>a2</span><span class=p>[</span><span class=n>y</span><span class=p>:(</span><span class=n>y</span><span class=o>+</span><span class=n>s</span><span class=p>),</span><span class=n>x</span><span class=p>:(</span><span class=n>x</span><span class=o>+</span><span class=n>s</span><span class=p>)]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a2</span>
</span></span></code></pre></div><p>Now we had defined a simple noise funtion which is used to add some random noise pixels (blocks) to the input image &lsquo;a&rsquo;.Let&rsquo;s try to load and pass the image to test above noise function.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=n>image</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=s1>&#39;sample.png&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>decode_png</span><span class=p>(</span><span class=n>image</span> <span class=p>,</span> <span class=n>channels</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>convert_image_dtype</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>[</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>img_array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#cols, rows = img.size</span>
</span></span><span class=line><span class=cl><span class=c1># Add noise</span>
</span></span><span class=line><span class=cl><span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>add_noise</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img_array_noise</span><span class=p>)</span>
</span></span></code></pre></div><p><img class=img-fluid alt=images/Normal_Image.jpg src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/Normal_Image.png loading=lazy width=257 height=251>
<img class=img-fluid alt=images/noise_1.png src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/noise_1.png loading=lazy width=257 height=251></p><p>Great, We have successfully implemented the noise function.Lets implement some more funtions which are also behaving like above noise functions but with different different noises.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>contrast</span><span class=p>(</span><span class=n>img</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>img</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>random_contrast</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>img</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>contrast</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img_array_noise</span><span class=p>)</span>
</span></span></code></pre></div><p><img class=img-fluid alt=images/contrast.png src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/contrast.png loading=lazy width=257 height=251></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>pepper_noise</span><span class=p>(</span><span class=n>img</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>noise_factor</span> <span class=o>=</span> <span class=mf>0.08</span>
</span></span><span class=line><span class=cl>  <span class=n>input_image</span> <span class=o>=</span> <span class=n>img</span> <span class=o>+</span> <span class=n>noise_factor</span> <span class=o>*</span> <span class=n>tf</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>img</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>input_image</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>clip_by_value</span><span class=p>(</span><span class=n>input_image</span><span class=p>,</span> <span class=n>clip_value_min</span><span class=o>=</span><span class=mf>0.</span><span class=p>,</span> <span class=n>clip_value_max</span><span class=o>=</span><span class=mf>1.</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>input_image</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>pepper_noise</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img_array_noise</span><span class=p>)</span>
</span></span></code></pre></div><p><img class=img-fluid alt=images/pepperNoise.png src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/pepperNoise.png loading=lazy width=257 height=251></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>gaussian_noise</span><span class=p>(</span><span class=n>image</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>name_scope</span><span class=p>(</span><span class=s1>&#39;Add_gaussian_noise&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>noise</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=n>shape</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>shape</span><span class=p>(</span><span class=n>image</span><span class=p>),</span> <span class=n>mean</span><span class=o>=</span><span class=mf>0.0</span><span class=p>,</span> <span class=n>stddev</span><span class=o>=</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=mi>255</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>noise_img</span> <span class=o>=</span> <span class=n>image</span> <span class=o>+</span> <span class=n>noise</span>
</span></span><span class=line><span class=cl>        <span class=n>noise_img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>clip_by_value</span><span class=p>(</span><span class=n>noise_img</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>noise_img</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>gaussian_noise</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img_array_noise</span><span class=p>)</span>
</span></span></code></pre></div><p><img class=img-fluid alt=images/gaussinaNoise.png src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/gaussinaNoise.png loading=lazy width=257 height=251></p><p>Let&rsquo;s do the same for the whole data set and load them into pickle using numpy arrays for future use.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=s1>&#39;/content/drive/MyDrive/project&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=s1>&#39;data.pkl&#39;</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>():</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span><span class=o>=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=n>file</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;/content/drive/MyDrive/project/data.pkl&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>y</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([],</span><span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>   
</span></span><span class=line><span class=cl>  <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([],</span><span class=n>dtype</span><span class=o>=</span><span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>for</span> <span class=n>path</span><span class=p>,</span> <span class=n>subdirs</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=s1>&#39;path/training_images/&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>path</span><span class=p>,</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>decode_png</span><span class=p>(</span><span class=n>image</span> <span class=p>,</span> <span class=n>channels</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>convert_image_dtype</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>[</span><span class=mi>128</span><span class=p>,</span> <span class=mi>128</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=c1># Add noise</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>a</span><span class=o>%</span><span class=mi>4</span><span class=o>==</span><span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>add_noise</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>a</span><span class=o>%</span><span class=mi>4</span><span class=o>==</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>pepper_noise</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>a</span><span class=o>%</span><span class=mi>4</span><span class=o>==</span><span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>img_array_noise</span> <span class=o>=</span> <span class=n>gaussian_noise</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>img_array_noise</span> <span class=o>=</span><span class=n>contrast</span><span class=p>(</span><span class=n>img_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>,[</span><span class=n>img_array</span><span class=p>],</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y</span><span class=p>,[</span><span class=n>img_array_noise</span><span class=p>],</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span><span class=n>img_array</span><span class=o>.</span><span class=n>shape</span>
</span></span></code></pre></div><pre><code>((9287, 128, 128, 3), (128, 128, 3))
</code></pre><p>Lets check the loaded pickle data by loading the pickle.file and seee what comes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>data</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>5001</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Write to file.</span>
</span></span><span class=line><span class=cl>  <span class=n>file</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;/content/drive/MyDrive/project/data.pkl&#34;</span><span class=p>,</span> <span class=s2>&#34;wb&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>pickle</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>pickle</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>x_train</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span><span class=n>x_train_noisy</span><span class=o>.</span><span class=n>shape</span>
</span></span></code></pre></div><p><img class="img-fluid mx-auto d-block" alt=images/loadimg.png src=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/images/loadimg.png loading=lazy width=257 height=251></p><pre><code>((9287, 128, 128, 3), (9287, 128, 128, 3))
</code></pre><p>Yahooo! we are complete preprocessing the data for training GAN&rsquo;s.
Source <a href=files/data_preprocessing_for_restoration.ipynb>dataPreprocessing.ipynb</a></p><h2 id=check-part-2-for-gans-implementatio>##check part-2 for GAN&rsquo;s implementatio</h2><h5 align=center id=thanks-for-reading>Thanks for reading!</h5></div><hr><div class="post-navs d-flex mb-3 justify-content-evenly"><div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-left"></i>
<a href=https://g00g1y5p4.github.io/posts/imagerestorationusinggans_2/>Image Restoration Using GAN's Part-2</a></div><div class="post-nav post-next"><a href=https://g00g1y5p4.github.io/posts/driverdrowsinessdetection/>Driver Drowsiness Detection</a>
<i class="fas fa-fw fa-chevron-right"></i></div></div><section class=related-posts-wrapper><h3>Related Posts</h3><ul class=related-posts><li><a href=https://g00g1y5p4.github.io/posts/imagerestorationusinggans_2/>Image Restoration Using GAN's Part-2</a></li><li><a href=https://g00g1y5p4.github.io/posts/2048withpython/>2048 With Python</a></li><li><a href=https://g00g1y5p4.github.io/posts/simplevideocallapp/>A Simple Video Call App With Python Sockets</a></li></ul></section></div></article></div></div><aside class="col-lg-4 sidebar d-flex"><div class=container><section class="card row text-center profile component"><div class=card-body><div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="Akash Thota" src=https://g00g1y5p4.github.io/images/me.jpg loading=lazy></div><div class="col-12 profile-meta"><div class=profile-name>Akash Thota</div><div class=profile-bio>Intrested in integration Machine Learning with Computer Vision</div><div class=profile-company><i class="fas fa-fw fa-building"></i> ...</div><br><div class=profile-location><i class="fas fa-fw fa-map-marker-alt"></i> India</div><br><div class=profile-about><i class="fas fa-fw fa-user"></i><a href=https://g00g1y5p4.github.io/about/> About Me</a></div><br></div></div></section><section class="recent-posts row card component"><div class=card-body><h2 class=card-title>Recent Posts</h2><ul><li><a href=https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/>Vehicle Accident Detection Using FPGA</a></li><li><a href=https://g00g1y5p4.github.io/posts/driverdrowsinessdetection/>Driver Drowsiness Detection</a></li><li><a href=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/>Image Restoration Using GAN's Part-1</a></li><li><a href=https://g00g1y5p4.github.io/posts/imagerestorationusinggans_2/>Image Restoration Using GAN's Part-2</a></li><li><a href=https://g00g1y5p4.github.io/posts/2048withpython/>2048 With Python</a></li></ul></div></section><section class="taxonomies row card component"><div class=card-body><h2 class=card-title><a href=https://g00g1y5p4.github.io/categories>Categories</a></h2><div><a href=https://g00g1y5p4.github.io/categories/gans/ class="badge bg-primary text-white rounded post-taxonomy" title="GAN's">GAN's
</a><a href=https://g00g1y5p4.github.io/categories/computer-vision/ class="badge bg-primary text-white rounded post-taxonomy" title="Computer Vision">Computer Vision
</a><a href=https://g00g1y5p4.github.io/categories/fpga/ class="badge bg-primary text-white rounded post-taxonomy" title=FPGA>FPGA
</a><a href=https://g00g1y5p4.github.io/categories/game/ class="badge bg-primary text-white rounded post-taxonomy" title=Game>Game
</a><a href=https://g00g1y5p4.github.io/categories/socket/ class="badge bg-primary text-white rounded post-taxonomy" title=Socket>Socket</a></div></div></section><section class="taxonomies row card component"><div class=card-body><h2 class=card-title><a href=https://g00g1y5p4.github.io/tags>Tags</a></h2><div><a href=https://g00g1y5p4.github.io/tags/image-processing/ class="badge bg-primary text-white rounded post-taxonomy" title="Image Processing">Image Processing
</a><a href=https://g00g1y5p4.github.io/tags/deep-learning/ class="badge bg-primary text-white rounded post-taxonomy" title="Deep Learning">Deep Learning
</a><a href=https://g00g1y5p4.github.io/tags/machine-learning/ class="badge bg-primary text-white rounded post-taxonomy" title="Machine Learning">Machine Learning
</a><a href=https://g00g1y5p4.github.io/tags/de10nano/ class="badge bg-primary text-white rounded post-taxonomy" title=DE10Nano>DE10Nano
</a><a href=https://g00g1y5p4.github.io/tags/face-detection/ class="badge bg-primary text-white rounded post-taxonomy" title="Face Detection">Face Detection
</a><a href=https://g00g1y5p4.github.io/tags/imageprocessing/ class="badge bg-primary text-white rounded post-taxonomy" title=ImageProcessing>ImageProcessing
</a><a href=https://g00g1y5p4.github.io/tags/nodemcu/ class="badge bg-primary text-white rounded post-taxonomy" title=NodeMCU>NodeMCU
</a><a href=https://g00g1y5p4.github.io/tags/opencv/ class="badge bg-primary text-white rounded post-taxonomy" title=openCV>openCV</a></div></div></section></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center"><a class="nav-link social-link" target=_blank href=https://discord.com/invite/g00g1y5p4 title=Discord rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-discord"></i>
</a><a class="nav-link social-link" href=mailto:g00g1y5p4@gmail.com title=Email><i class="fas fa-fw fa-2x fa-envelope"></i>
</a><a class="nav-link social-link" target=_blank href=https://github.com/g00g1y5p4 title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i>
</a><a class="nav-link social-link" target=_blank href=https://linkedin.com/in/g00g1y5p4 title=LinkedIn rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-linkedin-in"></i>
</a><a class="nav-link social-link" target=_blank href=https://twitter.com/g00g1y5p4 title=Twitter rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-twitter"></i></a></nav><div class="copyright mb-2">Copyright © 2018-2022 Akash Thota. All Rights Reserved.</div></footer><script src=https://g00g1y5p4.github.io/js/bundle.min.21f40383829a5e09e1bc7814b9d60ac04991f88e25e212dc4d1f8335ea724d96.js integrity="sha256-IfQDg4KaXgnhvHgUudYKwEmR+I4l4hLcTR+DNepyTZY=" crossorigin=anonymous defer></script><script defer src=https://g00g1y5p4.github.io/js/viewer.min.d5e689af442b462d0316719f47a5500dee615db035e8fb1b699f07fefa700fd1.js integrity="sha256-1eaJr0QrRi0DFnGfR6VQDe5hXbA16PsbaZ8H/vpwD9E=" crossorigin=anonymous></script><script defer src=https://g00g1y5p4.github.io/js/katex.min.420100d264e66fa287a9e08a59a7ebc37c67ea27d3fe010c94a77e03dd06d3fc.js integrity="sha256-QgEA0mTmb6KHqeCKWafrw3xn6ifT/gEMlKd+A90G0/w=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-213801925-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>