<!doctype html><html lang=en data-mode=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Vehicle Accident Detection Using FPGA | g00g1y5p4's Blog</title><link rel=apple-touch-icon href=https://g00g1y5p4.github.io/images/favicons/apple-touch-icon.png sizes=180x180><link rel=icon href=https://g00g1y5p4.github.io/images/favicons/favicon-32x32.png sizes=32x32 type=image/png><link rel=icon href=https://g00g1y5p4.github.io/images/favicons/favicon-16x16.png sizes=16x16 type=image/png><link rel=manifest href=https://g00g1y5p4.github.io/images/favicons/manifest.json><link rel=icon href=https://g00g1y5p4.github.io/images/favicons/favicon.ico><meta name=keywords content><meta name=description content="This project detects the accident of an vechile and sends alarm and notifications to parent‚Äôs or guardian‚Äôs phone"><meta itemprop=name content="Vehicle Accident Detection Using FPGA"><meta itemprop=description content="This project detects the accident of an vechile and sends alarm and notifications to parent‚Äôs or guardian‚Äôs phone"><meta itemprop=datePublished content="2021-12-31T07:34:48+08:30"><meta itemprop=dateModified content="2021-12-31T07:34:48+08:30"><meta itemprop=wordCount content="1861"><meta itemprop=image content="https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/_card.png"><meta itemprop=keywords content="DE10Nano,NodeMCU,"><meta property="og:title" content="Vehicle Accident Detection Using FPGA"><meta property="og:description" content="This project detects the accident of an vechile and sends alarm and notifications to parent‚Äôs or guardian‚Äôs phone"><meta property="og:type" content="article"><meta property="og:url" content="https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/"><meta property="og:image" content="https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/_card.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-31T07:34:48+08:30"><meta property="article:modified_time" content="2021-12-31T07:34:48+08:30"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/_card.png"><meta name=twitter:title content="Vehicle Accident Detection Using FPGA"><meta name=twitter:description content="This project detects the accident of an vechile and sends alarm and notifications to parent‚Äôs or guardian‚Äôs phone"><meta name=twitter:site content="@g00g1y5p4"><link rel=preload href=https://g00g1y5p4.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin=anonymous as=style onload='this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://g00g1y5p4.github.io/css/bundle.min.fcd024e77e7ca8dc30926e1b5389582b45bdb44482ee20d1ae3aae2c00de9817.css integrity="sha256-/NAk5358qNwwkm4bU4lYK0W9tESC7iDRrjquLADemBc=" crossorigin=anonymous></noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Consolas" type=text/css media=all referrerpolicy=no-referrer><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Fira+Code" type=text/css media=all><style>body{font-family:consolas}code{font-family:fira code}code{tab-size:4}</style></head><body><script src=https://g00g1y5p4.github.io/js/bootstrap.min.062c2e66b557cb779d59cedff7e0cc76e84beb665a1076e474e87d940be44245.js integrity="sha256-BiwuZrVXy3edWc7f9+DMduhL62ZaEHbkdOh9lAvkQkU=" crossorigin=anonymous></script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top"><div class=container><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-bars"></i>
</button><a class="navbar-brand me-3" href=https://g00g1y5p4.github.io/>g00g1y5p4's Blog</a>
<button class=navbar-social-share type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasSocialShare aria-controls=offcanvasSocialShare aria-label="Toggle social share">
<i class="fas fa-share-alt"></i></button><div class="offcanvas offcanvas-bottom surface" tabindex=-1 id=offcanvasSocialShare aria-labelledby=offcanvasSocialShare><div class=offcanvas-header><h3 class=offcanvas-title>Share</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class=offcanvas-body><a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button" target=_blank href="https://twitter.com/intent/tweet?title=Vehicle%20Accident%20Detection%20Using%20FPGA&url=https%3a%2f%2fg00g1y5p4.github.io%2fposts%2fvehicleaccidentdetectionusingfpga%2f"><i class="fab fa-fw fa-twitter"></i> Twitter</a>
<a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fg00g1y5p4.github.io%2fposts%2fvehicleaccidentdetectionusingfpga%2f"><i class="fab fa-fw fa-facebook-f"></i> Facebook</a></div></div><button class=navbar-settings type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasSettings aria-controls=offcanvasSettings aria-label="Toggle settings">
<i class="fas fa-ellipsis-v"></i></button><div class="offcanvas offcanvas-end surface h-100" tabindex=-1 id=offcanvasSettings aria-labelledby=offcanvasSettings><div class=offcanvas-header><h3 class=offcanvas-title>Settings</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class=offcanvas-body><section class=setting><form class="font-size-switcher-form row"><div class=col-auto><label for=fontSize class=form-label><i class="fas fa-fw fa-font"></i> Font Size</label></div><div class="col-auto ms-auto"><input type=range class=form-range min=-2 max=2 id=fontSize></div></form></section><section class="setting palettes"><form class=row><div class=col-auto><label><i class="fas fa-fw fa-palette"></i> Palette</label></div><div class="col-auto ms-auto"><a id=btnPalette class="btn btn-sm btn-outline-primary" role=button aria-label=palettePicker><i class="fas fa-eye-dropper"></i></a></div></form><div class="mt-2 d-flex visually-hidden" id=palettePicker><button type=button id=palette-blue aria-label=Blue class="btn btn-sm palette" data-palette=blue>
</button><button type=button id=palette-blue-gray aria-label="Blue Gray" class="btn btn-sm palette" data-palette=blue-gray>
</button><button type=button id=palette-brown aria-label=Brown class="btn btn-sm palette" data-palette=brown>
</button><button type=button id=palette-cyan aria-label=Cyan class="btn btn-sm palette" data-palette=cyan>
</button><button type=button id=palette-green aria-label=Green class="btn btn-sm palette" data-palette=green>
</button><button type=button id=palette-indigo aria-label=Indigo class="btn btn-sm palette" data-palette=indigo>
</button><button type=button id=palette-orange aria-label=Orange class="btn btn-sm palette" data-palette=orange>
</button><button type=button id=palette-pink aria-label=Pink class="btn btn-sm palette" data-palette=pink>
</button><button type=button id=palette-purple aria-label=Purple class="btn btn-sm palette" data-palette=purple>
</button><button type=button id=palette-red aria-label=Red class="btn btn-sm palette" data-palette=red>
</button><button type=button id=palette-teal aria-label=Teal class="btn btn-sm palette" data-palette=teal>
</button><button type=button id=palette-yellow aria-label=Yellow class="btn btn-sm palette" data-palette=yellow></button></div></section></div></div><div class="collapse navbar-collapse" tabindex=-1 id=navbarSupportedContent aria-labelledby=navbarSupportedContent><ul class="navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/archives/><i class="fas fa-fw fa-file-archive"></i>Archives</a></li><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/categories/><i class="fas fa-fw fa-folder"></i>Categories</a></li><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/tags/><i class="fas fa-fw fa-tags"></i>Tags</a></li><li class=nav-item><a class=nav-link href=https://g00g1y5p4.github.io/series/><i class="fas fa-fw fa-columns"></i>Series</a></li></ul></div></div></nav></header><main role=main class=container><div class="row content"><div class=col-lg-8><div class=container><nav class="row card component" aria-label=breadcrumb><div class=card-body><ol class=breadcrumb><li class=breadcrumb-item><a href=https://g00g1y5p4.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://g00g1y5p4.github.io/posts/>Posts</a></li><li class="breadcrumb-item active">Vehicle Accident Detection Using FPGA</li></ol></div></nav><article class="row card component mb-4 post"><div class=post-panel-wrapper><div class="d-flex flex-column component rounded post-panel"><a id=sidebarToggler class="action d-none d-lg-block" role=button><i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i></a></div></div><div class=card-body><h1 class="card-title my-3">Vehicle Accident Detection Using FPGA</h1><div class=post-meta><span class=post-date title="created on"><i class="fas fa-fw fa-calendar-alt"></i>Dec 31, 2021
</span><span class=post-reading-time title="reading time"><i class="fas fa-fw fa-coffee"></i>9 min read
</span><a href=https://g00g1y5p4.github.io/categories/fpga/ class="badge rounded-pill text-white bg-primary post-taxonomy">FPGA</a><a href=https://g00g1y5p4.github.io/tags/de10nano/ class="badge rounded-pill text-white bg-primary post-taxonomy">DE10Nano</a><a href=https://g00g1y5p4.github.io/tags/nodemcu/ class="badge rounded-pill text-white bg-primary post-taxonomy">NodeMCU</a></div><div class="post-content mb-3"><h3 id=introduction>Introduction</h3><p>Have you seen my previous post? If yes, I know you will definitely come here to see my new post.. üòå.
what if your answer is No? Then you will definitely come here next timeü•≤.</p><p>What&rsquo;s new this timeüôÑ?&mldr; Vehicle Accident detection using FPGA üòÆ‚Äçüí®.</p><h4 id=ew-fpga-whats-that>Ew? FPGAüò¶? What&rsquo;s that?</h4><p>Field Programmable Gate Arrays (FPGAs) are semiconductor devices that are based around a matrix of configurable logic blocks (CLBs) connected via programmable interconnects. FPGAs can be reprogrammed to desired application or functionality requirements after manufacturing.FPGAs contain an array of programmable logic blocks, and a hierarchy of reconfigurable interconnects allowing blocks to be wired together.An FPGA can be used to solve any problem which is computable. This is trivially proven by the fact that FPGAs can be used to implement a soft microprocessor.</p><p>I think its not just simple as I said. It&rsquo;s easy to understand and Hard to learnüòâ.</p><h4 id=what-actually-we-did-in-this-project>What actually we did in this project?</h4><p>We had used the DE10Nano FPGA board to program. DE10Nano FPGA Board has 2 different parts:</p><ol><li><p>FPGA</p></li><li><p>HPS &mdash; Hard Processor System with a wealth of peripherals onboard for creating some interesting applications</p></li></ol><p><img class=img-fluid alt=images/de10nano.png src=https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/de10nano.png loading=lazy width=427 height=332></p><p>The security of the vehicles can be achieved by using two
methods on road and the other one is off road. On road
means providing security from the accidents..So We are decided to Save lives from accidents. We are using ADXL sensor means Accelometer aka GyroScope, Magentometer to determine the vehicle position on the ground.</p><p>Have you think that this idea is already developed in CHITRALAHARI(Telugu) movie üòíü§´? Whatever, but we dont take this idea from any movie. No means noüôÑ, we dont take it from thereü•≤, Haha&mldr;</p><p>Lets dive into the project development and let me explain the basics code for this system. It has developed using python, C, Embedded-C, Java the development of android application has done using eclipse and this overall implementation can run based on IOT.</p><p>Huh.. number of languaguesü§î..Do we really need 4-5 languages or am I making some show off üò¢? Ofcourse, Yes. YesüôÑ? show offüòÖ? No. Not for show off. In HPS, If we want to access accelometer we have to access via protocols using some code. So thats why I&rsquo;m using C language to access.</p><h5 id=including-required-libraries-and-define-paths-for-i2c-protocol-event-file-to-access-adxl-sensor>Including required libraries and Define paths for i2c protocol event file to access ADXL sensor.</h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/stat.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;fcntl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;error.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;errno.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;limits.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;linux/input.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define INPUT_DEV_NODE &#34;/dev/input/by-path/platform-ffc04000.i2c-event&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define SYSFS_DEVICE_DIR &#34;/sys/devices/platform/soc/ffc04000.i2c/i2c-0/0-0053/&#34;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define EV_CODE_X (0)
</span></span></span><span class=line><span class=cl><span class=cp>#define EV_CODE_Y (1)
</span></span></span><span class=line><span class=cl><span class=cp>#define EV_CODE_Z (2)
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define LOOP_COUNT (1000)
</span></span></span></code></pre></div><h5 id=let-me-define-a-function-to-overwrite-the-files-data-to-access-adxl>Let me define a function to overwrite the files data to access ADXL</h5><p>Initially the ADXL sensor is disabled. So we need to overwrite the data and enable the ADXL.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>write_sysfs_cntl_file</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>dir_name</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>file_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>write_str</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kt>char</span> <span class=n>path</span><span class=p>[</span><span class=n>PATH_MAX</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>path_length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>file_fd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// create the path to the file we need to open
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>path_length</span> <span class=o>=</span> <span class=n>snprintf</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>PATH_MAX</span><span class=p>,</span> <span class=s>&#34;%s/%s&#34;</span><span class=p>,</span>	<span class=n>dir_name</span><span class=p>,</span> <span class=n>file_name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>path_length</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&#34;path output error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>path_length</span> <span class=o>&gt;=</span> <span class=n>PATH_MAX</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&#34;path length overflow&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// open the file
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>file_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>O_WRONLY</span> <span class=o>|</span> <span class=n>O_SYNC</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>file_fd</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;could not open file &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=c1>// write the string to the file
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>result</span> <span class=o>=</span> <span class=n>write</span><span class=p>(</span><span class=n>file_fd</span><span class=p>,</span> <span class=n>write_str</span><span class=p>,</span> <span class=n>strlen</span><span class=p>(</span><span class=n>write_str</span><span class=p>));</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;writing to &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>((</span><span class=n>size_t</span><span class=p>)(</span><span class=n>result</span><span class=p>)</span> <span class=o>!=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>write_str</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;buffer underflow writing &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// close the file
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>result</span> <span class=o>=</span> <span class=n>close</span><span class=p>(</span><span class=n>file_fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;could not close file &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>path</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=enable-and-access-adxl-sensor>Enable and Access ADXL sensor</h5><p>We can enable adxl sensor in de10nano by writing &ldquo;0&rdquo; in /sys/devices/platform/soc/ffc04000.i2c/i2c-0/0-0053/disable file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// enable adxl
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;disable&#34;</span><span class=p>,</span> <span class=s>&#34;0&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// set the sample rate to maximum
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;rate&#34;</span><span class=p>,</span> <span class=s>&#34;15&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// do not auto sleep
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;autosleep&#34;</span><span class=p>,</span> <span class=s>&#34;0&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// open the event device node
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>event_dev_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=n>input_dev_node</span><span class=p>,</span> <span class=n>O_RDONLY</span> <span class=o>|</span> <span class=n>O_SYNC</span><span class=p>);</span>
</span></span></code></pre></div><p>So we enabled the ADXL sensor and already opened the device to get input values from ADXL sensor.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=n>event_dev_fd</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;could not open file &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=c1>// read the current state of each axis
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span> <span class=p>;</span> <span class=n>i</span><span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>result</span> <span class=o>=</span> <span class=n>ioctl</span> <span class=p>(</span><span class=n>event_dev_fd</span><span class=p>,</span> <span class=n>EVIOCGABS</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=o>&amp;</span><span class=n>the_absinfo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;ioctl from &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>result</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>event_dev_fd</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>the_event</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>			<span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>));</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;reading %d from &#39;%s&#39;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>				<span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>!=</span> <span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&#34;did not read %d bytes from &#39;%s&#39;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>				<span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// read the current state of each axis
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span> <span class=p>;</span> <span class=n>i</span><span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>result</span> <span class=o>=</span> <span class=n>ioctl</span> <span class=p>(</span><span class=n>event_dev_fd</span><span class=p>,</span> <span class=n>EVIOCGABS</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>				<span class=o>&amp;</span><span class=n>the_absinfo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;ioctl from &#39;%s&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>		<span class=n>abs_value_array</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>the_absinfo</span><span class=p>.</span><span class=n>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d %d %d&#34;</span><span class=p>,</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>
</span></span></code></pre></div><p>Let me explain the above code, otherwise its looks like I copied from some sourceü§ß.</p><p>I forgot to say that What is ADXL sensor and what it will return as output? Yeah, yeah We use ADXL sensor aka GyroScope in mobile phones also. I think that pubG also uses the Gyroscope and detect if players got accidentüòÇ. I am right amn&rsquo;t Iü•±?</p><p>Jokes apart. GryoScope is a device used for measuring or maintaining orientation and angular velocity. It is a spinning wheel or disc in which the axis of rotation (spin axis) is free to assume any orientation by itself.
So if we want to determine a position in a 3rd space we actually want x,y,z coordinates. Like this way ADXL sensor also return x,y,z coordinates of a device.
Those <strong>x,y,z</strong> coordinates are printed at last of the above code which are taken from device&rsquo;s triggered event.</p><p>So&mldr;! So what? I think now you guys also do this project.
Whatü§Ø? Did you detect any accident? No. Then How can you finish this blog here?&mldr; What you guys are thinking is right, but I have explained you everything. Looks like I&rsquo;m crazy, amn&rsquo;t I? Ofcourse, may be I&rsquo;müòâ.</p><p>Ok Let me explain in details how I finised, Dont worry..üòå!</p><h5 id=accident-detection-using-adxl-sensor-values>Accident detection using ADXL Sensor values</h5><p>If you run a loop infinitely, what happens? what happens&mldr; system got stucked..üòÖ. usshü§´ Dont make jokes..
if we run a loop inifnitely, then we can calculate the difference between the values of coordinates in two consecutive seconds crosses threshhold of a normal vehicle position, then I considered it as an accident. But how?
how means &mldr; the sudden changes in coordinates represent sudden movement compare to its normal speed. So If a sudden change in coordinate then I thought some collision is occured.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>event_dev_fd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>input_dev_node</span> <span class=o>=</span> <span class=n>INPUT_DEV_NODE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>loop</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>input_event</span> <span class=n>the_event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>input_absinfo</span> <span class=n>the_absinfo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>last_value_x</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>last_value_y</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>last_value_z</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>x_abs_value_array</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>y_abs_value_array</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>z_abs_value_array</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>int</span> <span class=n>check</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>system</span><span class=p>(</span><span class=s>&#34;chmod 777 /sys/class/gpio/export&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=n>system</span><span class=p>(</span><span class=s>&#34;echo 107 &gt; /sys/class/gpio/export&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=n>system</span><span class=p>(</span><span class=s>&#34;echo out &gt; /sys/class/gpio/gpio107/direction&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=n>system</span><span class=p>(</span><span class=s>&#34;echo 1 &gt; /sys/class/gpio/gpio107/value&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// enable adxl
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;disable&#34;</span><span class=p>,</span> <span class=s>&#34;0&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// set the sample rate to maximum
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;rate&#34;</span><span class=p>,</span> <span class=s>&#34;15&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// do not auto sleep
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;autosleep&#34;</span><span class=p>,</span> <span class=s>&#34;0&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=c1>// open the event device node
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>event_dev_fd</span> <span class=o>=</span> <span class=n>open</span><span class=p>(</span><span class=n>input_dev_node</span><span class=p>,</span> <span class=n>O_RDONLY</span> <span class=o>|</span> <span class=n>O_SYNC</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>event_dev_fd</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;could not open file &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=c1>// read the current state of each axis
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span> <span class=p>;</span> <span class=n>i</span><span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>result</span> <span class=o>=</span> <span class=n>ioctl</span> <span class=p>(</span><span class=n>event_dev_fd</span><span class=p>,</span> <span class=n>EVIOCGABS</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=o>&amp;</span><span class=n>the_absinfo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;ioctl from &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// read the next LOOP_COUNT events
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>for</span><span class=p>(</span><span class=n>loop</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;;</span> <span class=n>loop</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=c1>// read the next event
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=n>result</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>event_dev_fd</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>the_event</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>				<span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>));</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;reading %d from &#39;%s&#39;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>					<span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>),</span>
</span></span><span class=line><span class=cl>					<span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>!=</span> <span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>))</span>
</span></span><span class=line><span class=cl>			<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=s>&#34;did not read %d bytes from &#39;%s&#39;&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>					<span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>input_event</span><span class=p>),</span>
</span></span><span class=line><span class=cl>					<span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=c1>// read the current state of each axis
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=k>for</span><span class=p>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span> <span class=p>;</span> <span class=n>i</span><span class=o>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>result</span> <span class=o>=</span> <span class=n>ioctl</span> <span class=p>(</span><span class=n>event_dev_fd</span><span class=p>,</span> <span class=n>EVIOCGABS</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>					<span class=o>&amp;</span><span class=n>the_absinfo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;ioctl from &#39;%s&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>						<span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>				
</span></span><span class=line><span class=cl>			<span class=n>abs_value_array</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>the_absinfo</span><span class=p>.</span><span class=n>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>last_value_x</span><span class=o>!=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>last_value_y</span><span class=o>!=</span><span class=mi>0</span> <span class=o>||</span> <span class=n>last_value_y</span><span class=o>!=</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>(((</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_x</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>200</span> <span class=o>||</span> <span class=p>(</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_y</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>200</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>((</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_x</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>200</span> <span class=o>||</span> <span class=p>(</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_z</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>200</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=p>((</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_y</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>200</span> <span class=o>||</span> <span class=p>(</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_z</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>200</span><span class=p>)){</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_x</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_y</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_z</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34; -- %d,%d,%d ----- </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>					<span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=n>system</span><span class=p>(</span><span class=s>&#34;echo 0 &gt; /sys/class/gpio/gpio107/value&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34; ------------  accident occurs ----------</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>((</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_x</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>300</span> <span class=o>||</span> <span class=p>(</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_y</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>300</span> <span class=o>||</span> <span class=p>(</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_z</span><span class=p>))</span><span class=o>&gt;</span><span class=mi>300</span><span class=p>){</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_x</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_y</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>abs</span><span class=p>(</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>-</span><span class=n>last_value_z</span><span class=p>));</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34; ------------- %d,%d,%d ----------------- </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>					<span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=n>system</span><span class=p>(</span><span class=s>&#34;echo 0 &gt; /sys/class/gpio/gpio107/value&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34; ------------  accident occurs ----------</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>check</span><span class=o>%</span><span class=mi>50</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=n>last_value_x</span> <span class=o>=</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>			<span class=n>last_value_y</span> <span class=o>=</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>			<span class=n>last_value_z</span> <span class=o>=</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d,%d,%d ----------------- </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>					<span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=n>check</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>x_abs_value_array</span><span class=o>!=</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>y_abs_value_array</span><span class=o>!=</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=n>z_abs_value_array</span><span class=o>!=</span><span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>){</span>
</span></span><span class=line><span class=cl>			<span class=n>check</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d,%d,%d --- %d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>					<span class=n>check</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>x_abs_value_array</span> <span class=o>=</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>		<span class=n>y_abs_value_array</span> <span class=o>=</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>		<span class=n>z_abs_value_array</span> <span class=o>=</span> <span class=n>abs_value_array</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>result</span> <span class=o>=</span> <span class=n>close</span><span class=p>(</span><span class=n>event_dev_fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=n>result</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>error</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>errno</span><span class=p>,</span> <span class=s>&#34;could not close file &#39;%s&#39;&#34;</span><span class=p>,</span> <span class=n>input_dev_node</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// disable adxl
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>write_sysfs_cntl_file</span><span class=p>(</span><span class=n>SYSFS_DEVICE_DIR</span><span class=p>,</span> <span class=s>&#34;disable&#34;</span><span class=p>,</span> <span class=s>&#34;1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><a href=files/watch.c>watch.c</a></p><p>In the above code, I power up the 107th gpio pin in DE10Nano when collision occured. Yooo We did it..!
Whatüòµ? .. You just did accident detection, but how others can notice that accident has been happend to thier vehicle? Author is irritating broüòñ huhh?</p><p>Oooov oov O.. I just forget. Dont tease me broüòï,I will explain.
<img class=img-fluid alt=images/final.png src=https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/final.png loading=lazy width=364 height=379></p><h5 id=nodemcu>NodeMCU</h5><p>I have connected the 107th gpio output wire to NodeMCU to take input.
So when the 107th gpio pin is powered up, then the NodeMCU read the it and sends the data to CLOUD.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;ESP8266WiFi.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;WiFiClient.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;ESP8266WebServer.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;Adafruit_MQTT.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;Adafruit_MQTT_Client.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define AIO_SERVER      &#34;io.adafruit.com&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define AIO_SERVERPORT  1883
</span></span></span><span class=line><span class=cl><span class=cp>#define AIO_USERNAME    &#34;g00g1y5p4&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define AIO_KEY         &#34;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#34;  </span><span class=c1>// Obtained from account info on io.adafruit.com          
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>s</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>k</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cm>/* Set these to your desired credentials. */</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ssid</span> <span class=o>=</span> <span class=s>&#34;SSID&#34;</span><span class=p>;</span> <span class=c1>//Enter your WIFI ss
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>password</span> <span class=o>=</span> <span class=s>&#34;PASSWD&#34;</span><span class=p>;</span> <span class=c1>//Enter your WIFI password
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ESP8266WebServer</span> <span class=nf>server</span><span class=p>(</span><span class=mi>80</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>handleRoot</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>server</span><span class=p>.</span><span class=n>send</span><span class=p>(</span><span class=mi>200</span><span class=p>,</span> <span class=s>&#34;text/html&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>handleSave</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>server</span><span class=p>.</span><span class=n>arg</span><span class=p>(</span><span class=s>&#34;pass&#34;</span><span class=p>)</span> <span class=o>!=</span> <span class=s>&#34;&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>server</span><span class=p>.</span><span class=n>arg</span><span class=p>(</span><span class=s>&#34;pass&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>WiFiClient</span> <span class=n>client</span><span class=p>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1>// Setup the MQTT client class by passing in the WiFi client and MQTT server and login details.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Adafruit_MQTT_Client</span> <span class=nf>mqtt</span><span class=p>(</span><span class=o>&amp;</span><span class=n>client</span><span class=p>,</span> <span class=n>AIO_SERVER</span><span class=p>,</span> <span class=n>AIO_SERVERPORT</span><span class=p>,</span> <span class=n>AIO_USERNAME</span><span class=p>,</span> <span class=n>AIO_KEY</span><span class=p>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>Adafruit_MQTT_Publish</span> <span class=n>Attendance</span> <span class=o>=</span> <span class=n>Adafruit_MQTT_Publish</span><span class=p>(</span><span class=o>&amp;</span><span class=n>mqtt</span><span class=p>,</span> <span class=n>AIO_USERNAME</span> <span class=s>&#34;/feeds/iot&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>pinMode</span><span class=p>(</span><span class=n>LED_BUILTIN</span><span class=p>,</span> <span class=n>OUTPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>3000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=mi>115200</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>pinMode</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>INPUT_PULLUP</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>WiFi</span><span class=p>.</span><span class=n>begin</span><span class=p>(</span><span class=n>ssid</span><span class=p>,</span> <span class=n>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>WiFi</span><span class=p>.</span><span class=n>status</span><span class=p>()</span> <span class=o>!=</span> <span class=n>WL_CONNECTED</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>delay</span><span class=p>(</span><span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=s>&#34;.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>pinMode</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=n>INPUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>server</span><span class=p>.</span><span class=n>on</span><span class=p>(</span><span class=s>&#34;/Python&#34;</span><span class=p>,</span> <span class=n>handleRoot</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>server</span><span class=p>.</span><span class=n>on</span> <span class=p>(</span><span class=s>&#34;/save&#34;</span><span class=p>,</span> <span class=n>handleSave</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>server</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=n>connect</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>connect</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>print</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Connecting to Adafruit IO... &#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=kt>int8_t</span> <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>((</span><span class=n>ret</span> <span class=o>=</span> <span class=n>mqtt</span><span class=p>.</span><span class=n>connect</span><span class=p>())</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=p>(</span><span class=n>ret</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=mi>1</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Wrong protocol&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=mi>2</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;ID rejected&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=mi>3</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Server unavail&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=mi>4</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Bad user/pass&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=mi>5</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Not authed&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>case</span> <span class=mi>6</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Failed to subscribe&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>default</span><span class=o>:</span> <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Connection failed&#34;</span><span class=p>));</span> <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>ret</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>mqtt</span><span class=p>.</span><span class=n>disconnect</span><span class=p>();</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Retrying connection...&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>delay</span><span class=p>(</span><span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Adafruit IO Connected!&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=n>Attendance</span><span class=p>.</span><span class=n>publish</span><span class=p>(</span><span class=s>&#34;g00g1y&#34;</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>          <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Failed&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Sent!&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>loop</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>server</span><span class=p>.</span><span class=n>handleClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>digitalRead</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>==</span> <span class=n>HIGH</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=s>&#34;LOW&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>digitalRead</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>==</span><span class=n>LOW</span> <span class=o>&amp;&amp;</span> <span class=n>i</span><span class=o>==</span><span class=mi>0</span> <span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>s</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=n>Attendance</span><span class=p>.</span><span class=n>publish</span><span class=p>(</span><span class=s>&#34;reset&#34;</span><span class=p>))</span> <span class=p>{</span>    
</span></span><span class=line><span class=cl>          <span class=c1>//Publish to Adafrui
</span></span></span><span class=line><span class=cl><span class=c1></span>              <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Failed&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>i</span><span class=o>+=</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Sent!&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>delay</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>analogRead</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>250</span> <span class=o>&amp;&amp;</span> <span class=n>k</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>n</span><span class=o>==</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>         <span class=n>n</span><span class=o>+=</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=o>!</span> <span class=n>Attendance</span><span class=p>.</span><span class=n>publish</span><span class=p>(</span><span class=s>&#34;g00g1yg00g1y&#34;</span><span class=p>))</span> <span class=p>{</span>    
</span></span><span class=line><span class=cl>          <span class=c1>//Publish to Adafrui
</span></span></span><span class=line><span class=cl><span class=c1></span>              <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Failed&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=n>k</span><span class=o>+=</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=n>Serial</span><span class=p>.</span><span class=n>println</span><span class=p>(</span><span class=n>F</span><span class=p>(</span><span class=s>&#34;Sent!&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=n>analogRead</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=o>&lt;=</span><span class=mi>200</span> <span class=o>&amp;&amp;</span> <span class=n>k</span><span class=o>!=</span><span class=mi>0</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=n>n</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><img class=img-fluid alt=images/node.png src=https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/node.png loading=lazy width=564 height=325></p><p><a href=files/send_alarm.ino>send_alarm.ino</a></p><p>And I created an Android Application to request the cloud data and if the accident code is detected then the alarm will play sound continuously through that application even if we terminate the Application&rsquo;s background process.</p><p><img class=img-fluid alt=images/detect.png src=https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/images/detect.png loading=lazy width=579 height=338></p><p>If accident occured&mldr; Led will blink.</p><p><a href=https://github.com/g00g1y5p4/Vehicle-Accident-Detection-using-DE10-Nano target=_blank rel="noopener noreferrer">Vehicle-Accident-Detection-using-DE10-Nano</a></p><p>Hope you guys like and Subscribe to this Utube account üòÇüòÇ.</p><hr><h5 align=center id=thanks-for-reading>Thanks for reading!</h5></div><hr><div class="post-navs d-flex mb-3 justify-content-evenly"><div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-left"></i>
<a href=https://g00g1y5p4.github.io/posts/driverdrowsinessdetection/>Driver Drowsiness Detection</a></div><div class="post-nav post-next"><a href=https://g00g1y5p4.github.io/posts/depthestimationofapothole/>Depth Estimation of a Pothole on Roads</a>
<i class="fas fa-fw fa-chevron-right"></i></div></div><section class=related-posts-wrapper><h3>Related Posts</h3><ul class=related-posts><li><a href=https://g00g1y5p4.github.io/posts/depthestimationofapothole/>Depth Estimation of a Pothole on Roads</a></li><li><a href=https://g00g1y5p4.github.io/posts/driverdrowsinessdetection/>Driver Drowsiness Detection</a></li><li><a href=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/>Image Restoration Using GAN's Part-1</a></li><li><a href=https://g00g1y5p4.github.io/posts/imagerestorationusinggans_2/>Image Restoration Using GAN's Part-2</a></li><li><a href=https://g00g1y5p4.github.io/posts/2048withpython/>2048 With Python</a></li></ul></section></div></article></div></div><aside class="col-lg-4 sidebar d-flex"><div class=container><section class="card row text-center profile component"><div class=card-body><div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="Akash Thota" src=https://g00g1y5p4.github.io/images/me.jpg loading=lazy></div><div class="col-12 profile-meta"><div class=profile-name>Akash Thota</div><div class=profile-bio>Intrested in integration Machine Learning with Computer Vision</div><div class=profile-company><i class="fas fa-fw fa-building"></i> ...</div><br><div class=profile-location><i class="fas fa-fw fa-map-marker-alt"></i> India</div><br><div class=profile-about><i class="fas fa-fw fa-user"></i><a href=https://g00g1y5p4.github.io/about/> About Me</a></div><br></div></div></section><section class="recent-posts row card component"><div class=card-body><h2 class=card-title>Recent Posts</h2><ul><li><a href=https://g00g1y5p4.github.io/posts/depthestimationofapothole/>Depth Estimation of a Pothole on Roads</a></li><li><a href=https://g00g1y5p4.github.io/posts/vehicleaccidentdetectionusingfpga/>Vehicle Accident Detection Using FPGA</a></li><li><a href=https://g00g1y5p4.github.io/posts/driverdrowsinessdetection/>Driver Drowsiness Detection</a></li><li><a href=https://g00g1y5p4.github.io/posts/imagrestorationusinggans_1/>Image Restoration Using GAN's Part-1</a></li><li><a href=https://g00g1y5p4.github.io/posts/imagerestorationusinggans_2/>Image Restoration Using GAN's Part-2</a></li></ul></div></section><section class="taxonomies row card component"><div class=card-body><h2 class=card-title><a href=https://g00g1y5p4.github.io/categories>Categories</a></h2><div><a href=https://g00g1y5p4.github.io/categories/gans/ class="badge bg-primary text-white rounded post-taxonomy" title="GAN's">GAN's
</a><a href=https://g00g1y5p4.github.io/categories/computer-vision/ class="badge bg-primary text-white rounded post-taxonomy" title="Computer Vision">Computer Vision
</a><a href=https://g00g1y5p4.github.io/categories/fpga/ class="badge bg-primary text-white rounded post-taxonomy" title=FPGA>FPGA
</a><a href=https://g00g1y5p4.github.io/categories/game/ class="badge bg-primary text-white rounded post-taxonomy" title=Game>Game
</a><a href=https://g00g1y5p4.github.io/categories/socket/ class="badge bg-primary text-white rounded post-taxonomy" title=Socket>Socket</a></div></div></section><section class="taxonomies row card component"><div class=card-body><h2 class=card-title><a href=https://g00g1y5p4.github.io/tags>Tags</a></h2><div><a href=https://g00g1y5p4.github.io/tags/image-processing/ class="badge bg-primary text-white rounded post-taxonomy" title="Image Processing">Image Processing
</a><a href=https://g00g1y5p4.github.io/tags/deep-learning/ class="badge bg-primary text-white rounded post-taxonomy" title="Deep Learning">Deep Learning
</a><a href=https://g00g1y5p4.github.io/tags/machine-learning/ class="badge bg-primary text-white rounded post-taxonomy" title="Machine Learning">Machine Learning
</a><a href=https://g00g1y5p4.github.io/tags/de10nano/ class="badge bg-primary text-white rounded post-taxonomy" title=DE10Nano>DE10Nano
</a><a href=https://g00g1y5p4.github.io/tags/face-detection/ class="badge bg-primary text-white rounded post-taxonomy" title="Face Detection">Face Detection
</a><a href=https://g00g1y5p4.github.io/tags/imageprocessing/ class="badge bg-primary text-white rounded post-taxonomy" title=ImageProcessing>ImageProcessing
</a><a href=https://g00g1y5p4.github.io/tags/nodemcu/ class="badge bg-primary text-white rounded post-taxonomy" title=NodeMCU>NodeMCU
</a><a href=https://g00g1y5p4.github.io/tags/opencv/ class="badge bg-primary text-white rounded post-taxonomy" title=openCV>openCV</a></div></div></section></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav my-2 justify-content-center"><a class="nav-link social-link" target=_blank href=https://discord.com/invite/g00g1y5p4 title=Discord rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-discord"></i>
</a><a class="nav-link social-link" href=mailto:g00g1y5p4@gmail.com title=Email><i class="fas fa-fw fa-2x fa-envelope"></i>
</a><a class="nav-link social-link" target=_blank href=https://github.com/g00g1y5p4 title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i>
</a><a class="nav-link social-link" target=_blank href=https://linkedin.com/in/g00g1y5p4 title=LinkedIn rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-linkedin-in"></i>
</a><a class="nav-link social-link" target=_blank href=https://twitter.com/g00g1y5p4 title=Twitter rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-twitter"></i></a></nav><div class="copyright mb-2">Copyright ¬© 2018-2022 Akash Thota. All Rights Reserved.</div></footer><script src=https://g00g1y5p4.github.io/js/bundle.min.21f40383829a5e09e1bc7814b9d60ac04991f88e25e212dc4d1f8335ea724d96.js integrity="sha256-IfQDg4KaXgnhvHgUudYKwEmR+I4l4hLcTR+DNepyTZY=" crossorigin=anonymous defer></script><script defer src=https://g00g1y5p4.github.io/js/viewer.min.d5e689af442b462d0316719f47a5500dee615db035e8fb1b699f07fefa700fd1.js integrity="sha256-1eaJr0QrRi0DFnGfR6VQDe5hXbA16PsbaZ8H/vpwD9E=" crossorigin=anonymous></script><script defer src=https://g00g1y5p4.github.io/js/katex.min.420100d264e66fa287a9e08a59a7ebc37c67ea27d3fe010c94a77e03dd06d3fc.js integrity="sha256-QgEA0mTmb6KHqeCKWafrw3xn6ifT/gEMlKd+A90G0/w=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-213801925-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>